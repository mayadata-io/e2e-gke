## TODO: Modularize the gitlab yaml to reuse templates

## Define the stages & order of execution

stages:
  - CLUSTER-SETUP
  - PROVIDER-INFRA-SETUP

variables: 
  utils_path: "/builds/openebs/e2e-gke/script/utils"

## Setup the kubernetes cluster

gke-cluster:
  image: atulabhi/kops:v9
  stage: CLUSTER-SETUP 
  script:
    - sleep 10
  artifacts:
    paths:
      - .kube/

## Setup OpenEBS control plane

openebs-gke-deploy:
  image: atulabhi/kops:v9
  stage: PROVIDER-INFRA-SETUP
  dependencies:
    - gke-cluster
  script:
    - sleep 100 
  artifacts:
    paths:
      - .kube-openebs/

openebs-sc-deploy:
  image: atulabhi/kops:v9
  stage: PROVIDER-INFRA-SETUP
  dependencies:
    - openebs-gke-deploy
  script:
   - echo "Tested 1"
  artifacts:
    paths:
      - .kube-openebs/

